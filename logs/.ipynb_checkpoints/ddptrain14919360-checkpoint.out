MASTER_ADDR is 172.18.62.11
PING 172.18.62.11 (172.18.62.11) 56(84) bytes of data.
64 bytes from 172.18.62.11: icmp_seq=1 ttl=64 time=0.022 ms

--- 172.18.62.11 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.022/0.022/0.022/0.000 ms
W0714 22:02:48.262000 4167040 site-packages/torch/distributed/run.py:766] 
W0714 22:02:48.262000 4167040 site-packages/torch/distributed/run.py:766] *****************************************
W0714 22:02:48.262000 4167040 site-packages/torch/distributed/run.py:766] Setting OMP_NUM_THREADS environment variable for each process to be 1 in default, to avoid your system being overloaded, please further tune the variable for optimal performance in your application as needed. 
W0714 22:02:48.262000 4167040 site-packages/torch/distributed/run.py:766] *****************************************
[W714 22:02:48.222426995 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [paula11.sc.uni-leipzig.de]:19382 (errno: 97 - Address family not supported by protocol).
[W714 22:02:48.465272700 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [paula11.sc.uni-leipzig.de]:34797 (errno: 97 - Address family not supported by protocol).
[W714 22:02:52.420280710 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [paula11.sc.uni-leipzig.de]:34797 (errno: 97 - Address family not supported by protocol).
[W714 22:02:52.420836776 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [paula11.sc.uni-leipzig.de]:34797 (errno: 97 - Address family not supported by protocol).
[W714 22:02:52.421033305 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [paula11.sc.uni-leipzig.de]:34797 (errno: 97 - Address family not supported by protocol).
[W714 22:02:52.421379637 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [paula11.sc.uni-leipzig.de]:34797 (errno: 97 - Address family not supported by protocol).
wandb: Currently logged in as: coyfelix7 (coyfelix7-universit-t-leipzig) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
Using VAE-optimized preprocessing...
Using VAE-optimized preprocessing...
Using VAE-optimized preprocessing...
wandb: Tracking run with wandb version 0.21.0
wandb: Run data is saved locally in /home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/wandb/run-20250714_220253-nhjz7wve
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run cool-tree-189
wandb: ‚≠êÔ∏è View project at https://wandb.ai/coyfelix7-universit-t-leipzig/big_data_vae
wandb: üöÄ View run at https://wandb.ai/coyfelix7-universit-t-leipzig/big_data_vae/runs/nhjz7wve
Using VAE-optimized preprocessing...
Dataset loaded: 20000 cells √ó 100 genes
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
Dataset loaded: 20000 cells √ó 100 genes
Dataset loaded: 20000 cells √ó 100 genes
Dataset loaded: 20000 cells √ó 100 genes
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
Dataset loaded: 20000 cells √ó 100 genes
Dataset loaded: 20000 cells √ó 100 genes
paula11:4167064:4167064 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167064:4167064 [0] NCCL INFO Bootstrap: Using bond0:172.18.62.11<0>
paula11:4167064:4167064 [0] NCCL INFO cudaDriverVersion 12020
paula11:4167064:4167064 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
paula11:4167064:4167064 [0] NCCL INFO Comm config Blocking set to 1
paula11:4167066:4167066 [2] NCCL INFO cudaDriverVersion 12020
paula11:4167066:4167066 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167066:4167066 [2] NCCL INFO Bootstrap: Using bond0:172.18.62.11<0>
paula11:4167066:4167066 [2] NCCL INFO NCCL version 2.26.2+cuda12.2
paula11:4167066:4167066 [2] NCCL INFO Comm config Blocking set to 1
paula11:4167064:4167171 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
paula11:4167064:4167171 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
paula11:4167064:4167171 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167064:4167171 [0] NCCL INFO NET/Socket : Using [0]bond0:172.18.62.11<0>
paula11:4167064:4167171 [0] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
paula11:4167064:4167171 [0] NCCL INFO Using network Socket
paula11:4167064:4167171 [0] NCCL INFO ncclCommInitRankConfig comm 0x55721fef6670 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x4656ce8676d403e0 - Init START
paula11:4167066:4167172 [2] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
paula11:4167066:4167172 [2] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
paula11:4167066:4167172 [2] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167066:4167172 [2] NCCL INFO NET/Socket : Using [0]bond0:172.18.62.11<0>
paula11:4167066:4167172 [2] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
paula11:4167066:4167172 [2] NCCL INFO Using network Socket
paula11:4167066:4167172 [2] NCCL INFO ncclCommInitRankConfig comm 0x557ba7b532f0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 61000 commId 0x4656ce8676d403e0 - Init START
Dataset loaded: 20000 cells √ó 100 genes
paula11:4167065:4167065 [1] NCCL INFO cudaDriverVersion 12020
paula11:4167065:4167065 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167065:4167065 [1] NCCL INFO Bootstrap: Using bond0:172.18.62.11<0>
paula11:4167065:4167065 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
paula11:4167065:4167065 [1] NCCL INFO Comm config Blocking set to 1
paula11:4167065:4167173 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
paula11:4167065:4167173 [1] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
paula11:4167065:4167173 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167065:4167173 [1] NCCL INFO NET/Socket : Using [0]bond0:172.18.62.11<0>
paula11:4167065:4167173 [1] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
paula11:4167065:4167173 [1] NCCL INFO Using network Socket
paula11:4167065:4167173 [1] NCCL INFO ncclCommInitRankConfig comm 0x55d14c8e9f00 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 22000 commId 0x4656ce8676d403e0 - Init START
paula11:4167065:4167173 [1] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
Dataset loaded: 20000 cells √ó 100 genes
paula11:4167067:4167067 [3] NCCL INFO cudaDriverVersion 12020
paula11:4167067:4167067 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167067:4167067 [3] NCCL INFO Bootstrap: Using bond0:172.18.62.11<0>
paula11:4167067:4167067 [3] NCCL INFO NCCL version 2.26.2+cuda12.2
paula11:4167067:4167067 [3] NCCL INFO Comm config Blocking set to 1
paula11:4167067:4167176 [3] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
paula11:4167067:4167176 [3] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
paula11:4167067:4167176 [3] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
paula11:4167067:4167176 [3] NCCL INFO NET/Socket : Using [0]bond0:172.18.62.11<0>
paula11:4167067:4167176 [3] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
paula11:4167067:4167176 [3] NCCL INFO Using network Socket
paula11:4167067:4167176 [3] NCCL INFO ncclCommInitRankConfig comm 0x5611358106b0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId c1000 commId 0x4656ce8676d403e0 - Init START
paula11:4167067:4167176 [3] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
paula11:4167066:4167172 [2] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
paula11:4167064:4167171 [0] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
paula11:4167066:4167172 [2] NCCL INFO Bootstrap timings total 1.394850 (create 0.000034, send 0.000133, recv 1.372621, ring 0.000797, delay 0.000000)
paula11:4167067:4167176 [3] NCCL INFO Bootstrap timings total 0.022386 (create 0.000033, send 0.000147, recv 0.000185, ring 0.000083, delay 0.000000)
paula11:4167065:4167173 [1] NCCL INFO Bootstrap timings total 1.100280 (create 0.000033, send 0.000145, recv 0.000217, ring 1.076086, delay 0.000000)
paula11:4167064:4167171 [0] NCCL INFO Bootstrap timings total 1.401813 (create 0.000032, send 0.000136, recv 0.301693, ring 0.001143, delay 0.000000)
paula11:4167065:4167173 [1] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
paula11:4167064:4167171 [0] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
paula11:4167064:4167171 [0] NCCL INFO Setting affinity for GPU 0 to 010000,00000000
paula11:4167064:4167171 [0] NCCL INFO NVLS multicast support is not available on dev 0
paula11:4167065:4167173 [1] NCCL INFO Setting affinity for GPU 1 to 01,00000000
paula11:4167067:4167176 [3] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
paula11:4167065:4167173 [1] NCCL INFO NVLS multicast support is not available on dev 1
paula11:4167066:4167172 [2] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
paula11:4167067:4167176 [3] NCCL INFO Setting affinity for GPU 3 to 1fff0000,00000000,00000000
paula11:4167067:4167176 [3] NCCL INFO NVLS multicast support is not available on dev 3
paula11:4167066:4167172 [2] NCCL INFO Setting affinity for GPU 2 to 01
paula11:4167066:4167172 [2] NCCL INFO NVLS multicast support is not available on dev 2
paula11:4167067:4167176 [3] NCCL INFO comm 0x5611358106b0 rank 3 nRanks 4 nNodes 1 localRanks 4 localRank 3 MNNVL 0
paula11:4167067:4167176 [3] NCCL INFO Trees [0] -1/-1/-1->3->2 [1] -1/-1/-1->3->2
paula11:4167064:4167171 [0] NCCL INFO comm 0x55721fef6670 rank 0 nRanks 4 nNodes 1 localRanks 4 localRank 0 MNNVL 0
paula11:4167067:4167176 [3] NCCL INFO P2P Chunksize set to 131072
paula11:4167066:4167172 [2] NCCL INFO comm 0x557ba7b532f0 rank 2 nRanks 4 nNodes 1 localRanks 4 localRank 2 MNNVL 0
paula11:4167065:4167173 [1] NCCL INFO comm 0x55d14c8e9f00 rank 1 nRanks 4 nNodes 1 localRanks 4 localRank 1 MNNVL 0
paula11:4167064:4167171 [0] NCCL INFO Channel 00/02 : 0 1 2 3
paula11:4167064:4167171 [0] NCCL INFO Channel 01/02 : 0 1 2 3
paula11:4167066:4167172 [2] NCCL INFO Trees [0] 3/-1/-1->2->1 [1] 3/-1/-1->2->1
paula11:4167064:4167171 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
paula11:4167066:4167172 [2] NCCL INFO P2P Chunksize set to 131072
paula11:4167065:4167173 [1] NCCL INFO Trees [0] 2/-1/-1->1->0 [1] 2/-1/-1->1->0
paula11:4167064:4167171 [0] NCCL INFO P2P Chunksize set to 131072
paula11:4167065:4167173 [1] NCCL INFO P2P Chunksize set to 131072
paula11:4167064:4167171 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
paula11:4167067:4167183 [3] NCCL INFO [Proxy Service] Device 3 CPU core 85
paula11:4167067:4167184 [3] NCCL INFO [Proxy Service UDS] Device 3 CPU core 88
paula11:4167067:4167176 [3] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
paula11:4167067:4167176 [3] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
paula11:4167064:4167171 [0] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
paula11:4167064:4167171 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
paula11:4167066:4167172 [2] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
paula11:4167066:4167172 [2] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
paula11:4167065:4167173 [1] NCCL INFO threadThresholds 8/8/64 | 32/8/64 | 512 | 512
paula11:4167065:4167173 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
paula11:4167064:4167171 [0] NCCL INFO CC Off, workFifoBytes 1048576
paula11:4167067:4167176 [3] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
paula11:4167067:4167176 [3] NCCL INFO ncclCommInitRankConfig comm 0x5611358106b0 rank 3 nranks 4 cudaDev 3 nvmlDev 3 busId c1000 commId 0x4656ce8676d403e0 - Init COMPLETE
paula11:4167067:4167176 [3] NCCL INFO Init timings - ncclCommInitRankConfig: rank 3 nranks 4 total 0.21 (kernels 0.11, alloc 0.00, bootstrap 0.02, allgathers 0.00, topo 0.07, graphs 0.00, connections 0.01, rest 0.00)
paula11:4167064:4167171 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
paula11:4167066:4167172 [2] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
paula11:4167064:4167171 [0] NCCL INFO ncclCommInitRankConfig comm 0x55721fef6670 rank 0 nranks 4 cudaDev 0 nvmlDev 0 busId 1000 commId 0x4656ce8676d403e0 - Init COMPLETE
paula11:4167066:4167172 [2] NCCL INFO ncclCommInitRankConfig comm 0x557ba7b532f0 rank 2 nranks 4 cudaDev 2 nvmlDev 2 busId 61000 commId 0x4656ce8676d403e0 - Init COMPLETE
paula11:4167064:4167171 [0] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 4 total 1.59 (kernels 0.11, alloc 0.00, bootstrap 1.40, allgathers 0.00, topo 0.07, graphs 0.00, connections 0.01, rest 0.00)
paula11:4167066:4167172 [2] NCCL INFO Init timings - ncclCommInitRankConfig: rank 2 nranks 4 total 1.59 (kernels 0.11, alloc 0.00, bootstrap 1.39, allgathers 0.00, topo 0.07, graphs 0.00, connections 0.01, rest 0.00)
paula11:4167065:4167173 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
paula11:4167065:4167173 [1] NCCL INFO ncclCommInitRankConfig comm 0x55d14c8e9f00 rank 1 nranks 4 cudaDev 1 nvmlDev 1 busId 22000 commId 0x4656ce8676d403e0 - Init COMPLETE
paula11:4167064:4167188 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 48
paula11:4167065:4167173 [1] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 4 total 1.29 (kernels 0.11, alloc 0.00, bootstrap 1.10, allgathers 0.00, topo 0.07, graphs 0.00, connections 0.01, rest 0.00)
paula11:4167064:4167185 [0] NCCL INFO [Proxy Service] Device 0 CPU core 48
paula11:4167066:4167189 [2] NCCL INFO [Proxy Service UDS] Device 2 CPU core 0
paula11:4167066:4167186 [2] NCCL INFO [Proxy Service] Device 2 CPU core 0
paula11:4167065:4167190 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 32
paula11:4167065:4167187 [1] NCCL INFO [Proxy Service] Device 1 CPU core 32
paula11:4167067:4167193 [3] NCCL INFO Channel 00 : 3[3] -> 0[0] via SHM/direct/direct
paula11:4167067:4167193 [3] NCCL INFO Channel 01 : 3[3] -> 0[0] via SHM/direct/direct
paula11:4167065:4167194 [1] NCCL INFO Channel 00 : 1[1] -> 2[2] via SHM/direct/direct
paula11:4167066:4167191 [2] NCCL INFO Channel 00 : 2[2] -> 3[3] via SHM/direct/direct
paula11:4167064:4167192 [0] NCCL INFO Channel 00 : 0[0] -> 1[1] via SHM/direct/direct
paula11:4167065:4167194 [1] NCCL INFO Channel 01 : 1[1] -> 2[2] via SHM/direct/direct
paula11:4167066:4167191 [2] NCCL INFO Channel 01 : 2[2] -> 3[3] via SHM/direct/direct
paula11:4167064:4167192 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
paula11:4167065:4167194 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
paula11:4167064:4167192 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
paula11:4167067:4167193 [3] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
paula11:4167066:4167191 [2] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
[Rank 3] Calling model forward at epoch 1, batch size: 512
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/train_vae.py:41: UserWarning: Using a target size (torch.Size([512, 2])) that is different to the input size (torch.Size([512, 100])). This will likely lead to incorrect results due to broadcasting. Please ensure they have the same size.
  mse = F.mse_loss(recon_x, x, reduction='mean')
[rank3]: Traceback (most recent call last):
[rank3]:   File "/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/train_vae.py", line 175, in <module>
[rank3]:     train()
[rank3]:   File "/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/train_vae.py", line 141, in train
[rank3]:     loss, BCE, KLD = loss_function(recon_batch, data, mu, logvar, beta)
[rank3]:   File "/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/train_vae.py", line 41, in loss_function
[rank3]:     mse = F.mse_loss(recon_x, x, reduction='mean')
[rank3]:   File "/home/sc.uni-leipzig.de/ci72buri/.conda/envs/cell-vae/lib/python3.10/site-packages/torch/nn/functional.py", line 3884, in mse_loss
[rank3]:     expanded_input, expanded_target = torch.broadcast_tensors(input, target)
[rank3]:   File "/home/sc.uni-leipzig.de/ci72buri/.conda/envs/cell-vae/lib/python3.10/site-packages/torch/functional.py", line 77, in broadcast_tensors
[rank3]:     return _VF.broadcast_tensors(tensors)  # type: ignore[attr-defined]
[rank3]: RuntimeError: The size of tensor a (100) must match the size of tensor b (2) at non-singleton dimension 1
