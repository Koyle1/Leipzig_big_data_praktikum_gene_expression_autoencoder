[2025-07-14 03:10:06] Starting SLURM job 14905151 on clara10.sc.uni-leipzig.de
[2025-07-14 03:10:06] Job parameters: 4 tasks, 4 GPUs, 1 nodes
[2025-07-14 03:10:06] Loading required modules...
[2025-07-14 03:10:08] Activating conda environment...
[2025-07-14 03:10:08] Verifying environment...
Python 3.10.18
PyTorch version: 2.7.1+cu126
CUDA available: True
CUDA devices: 4
[2025-07-14 03:10:17] Checking training script...
[2025-07-14 03:10:17] Training script found: -rw-r--r-- 1 ci72buri sc_users 17162 Jul 14 03:09 train_vae.py
[2025-07-14 03:10:17] Testing training script import...
Training script import: SUCCESS
[2025-07-14 03:10:24] Checking required modules...
torch: OK
torch.distributed: OK
numpy: OK
wandb: OK
All required modules available
[2025-07-14 03:10:28] Configuring NCCL settings...
[2025-07-14 03:10:28] Setting up distributed training configuration...
[2025-07-14 03:10:28] Distributed training configuration:
[2025-07-14 03:10:28]   MASTER_ADDR: 172.26.10.10
[2025-07-14 03:10:28]   MASTER_PORT: 36162
[2025-07-14 03:10:28]   WORLD_SIZE: 4
[2025-07-14 03:10:28]   NODE_RANK: 0
[2025-07-14 03:10:28]   SLURM_GPUS_ON_NODE: 4
[2025-07-14 03:10:28]   SLURM_JOB_NUM_NODES: 1
[2025-07-14 03:10:28] Testing network connectivity...
PING 172.26.10.10 (172.26.10.10) 56(84) bytes of data.
64 bytes from 172.26.10.10: icmp_seq=1 ttl=64 time=0.053 ms

--- 172.26.10.10 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.053/0.053/0.053/0.000 ms
[2025-07-14 03:10:28] Testing GPU availability...
Mon Jul 14 03:10:28 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.230.02             Driver Version: 535.230.02   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  NVIDIA GeForce RTX 2080 Ti     On  | 00000000:05:00.0 Off |                  N/A |
|  0%   27C    P8              21W / 250W |      1MiB / 11264MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  NVIDIA GeForce RTX 2080 Ti     On  | 00000000:06:00.0 Off |                  N/A |
|  0%   27C    P8               1W / 250W |      1MiB / 11264MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   2  NVIDIA GeForce RTX 2080 Ti     On  | 00000000:28:00.0 Off |                  N/A |
|  0%   26C    P8              19W / 250W |      1MiB / 11264MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   3  NVIDIA GeForce RTX 2080 Ti     On  | 00000000:29:00.0 Off |                  N/A |
|  0%   26C    P8              20W / 250W |      1MiB / 11264MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
[2025-07-14 03:10:28] Checking torchrun availability...
/home/sc.uni-leipzig.de/ci72buri/.conda/envs/cell-vae/bin/torchrun
usage: torchrun [-h] [--nnodes NNODES] [--nproc-per-node NPROC_PER_NODE] [--rdzv-backend RDZV_BACKEND] [--rdzv-endpoint RDZV_ENDPOINT] [--rdzv-id RDZV_ID] [--rdzv-conf RDZV_CONF] [--standalone]
                [--max-restarts MAX_RESTARTS] [--monitor-interval MONITOR_INTERVAL] [--start-method {spawn,fork,forkserver}] [--role ROLE] [-m] [--no-python] [--run-path] [--log-dir LOG_DIR] [-r REDIRECTS] [-t TEE]
                [--local-ranks-filter LOCAL_RANKS_FILTER] [--node-rank NODE_RANK] [--master-addr MASTER_ADDR] [--master-port MASTER_PORT] [--local-addr LOCAL_ADDR] [--logs-specs LOGS_SPECS]
                training_script ...

[2025-07-14 03:10:31] Testing basic torchrun functionality...
Basic torchrun test passed
[2025-07-14 03:10:36] Creating distributed test script...
[2025-07-14 03:10:36] Testing distributed functionality...
Rank 0/2: Distributed initialization successfulRank 1/2: Distributed initialization successful

Rank 0: Using device cuda:0
Rank 1: Using device cuda:1
Rank 1: Basic tensor operations successful
Rank 0: Basic tensor operations successful
Rank 1: Test completed successfully
Rank 0: Test completed successfully
[2025-07-14 03:10:43] Starting distributed training with verbose output...
[2025-07-14 03:10:43] Command: torchrun --nproc_per_node=4 --nnodes=1 --node_rank=0 --rdzv_backend=c10d --rdzv_endpoint=172.26.10.10:36162 train_vae.py
[2025-07-14 03:10:43] Testing with 2 processes first...
[W714 03:10:45.354211067 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara10.sc.uni-leipzig.de]:36162 (errno: 97 - Address family not supported by protocol).
[W714 03:10:45.592618629 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara10.sc.uni-leipzig.de]:35361 (errno: 97 - Address family not supported by protocol).
[W714 03:10:51.122783222 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara10.sc.uni-leipzig.de]:35361 (errno: 97 - Address family not supported by protocol).
[W714 03:10:51.171715005 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara10.sc.uni-leipzig.de]:35361 (errno: 97 - Address family not supported by protocol).
2025-07-14 03:10:51,549 - rank_0 - INFO - Rank 0/2 initialized on device cuda:0
wandb: Currently logged in as: coyfelix7 (coyfelix7-universit-t-leipzig) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
Using VAE-optimized preprocessing...
wandb: Tracking run with wandb version 0.21.0
wandb: Run data is saved locally in /home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/wandb/run-20250714_031051-r6n4hsue
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run glowing-hill-170
wandb: ‚≠êÔ∏è View project at https://wandb.ai/coyfelix7-universit-t-leipzig/big_data_vae
wandb: üöÄ View run at https://wandb.ai/coyfelix7-universit-t-leipzig/big_data_vae/runs/r6n4hsue
Using VAE-optimized preprocessing...
Dataset loaded: 20000 cells √ó 100 genes
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
Dataset loaded: 20000 cells √ó 100 genes
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
Dataset loaded: 20000 cells √ó 100 genes
Dataset loaded: 20000 cells √ó 100 genes
2025-07-14 03:11:02,552 - rank_0 - INFO - Data loaders created. Dataset size: 20000
clara10:2702492:2702492 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara10:2702492:2702492 [0] NCCL INFO cudaDriverVersion 12020
clara10:2702492:2702492 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
clara10:2702492:2702492 [0] NCCL INFO Comm config Blocking set to 1
clara10:2702493:2702493 [1] NCCL INFO cudaDriverVersion 12020
clara10:2702493:2702493 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara10:2702493:2702493 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
clara10:2702493:2702493 [1] NCCL INFO Comm config Blocking set to 1
clara10:2702492:2702995 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
clara10:2702492:2702995 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
clara10:2702492:2702995 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara10:2702492:2702995 [0] NCCL INFO NET/Socket : Using [0]bond0:172.26.10.10<0>
clara10:2702492:2702995 [0] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
clara10:2702492:2702995 [0] NCCL INFO Using network Socket
clara10:2702492:2702995 [0] NCCL INFO ncclCommInitRankConfig comm 0x55ba4623b530 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 5000 commId 0xcb051e40260ef976 - Init START
clara10:2702493:2702998 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
clara10:2702493:2702998 [1] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
clara10:2702493:2702998 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara10:2702493:2702998 [1] NCCL INFO NET/Socket : Using [0]bond0:172.26.10.10<0>
clara10:2702493:2702998 [1] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
clara10:2702493:2702998 [1] NCCL INFO Using network Socket
clara10:2702493:2702998 [1] NCCL INFO ncclCommInitRankConfig comm 0x55c6b0c3d650 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 6000 commId 0xcb051e40260ef976 - Init START
clara10:2702493:2702998 [1] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
clara10:2702492:2702995 [0] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
clara10:2702493:2702998 [1] NCCL INFO TOPO/NET : Importing network plugins to topology
clara10:2702493:2702998 [1] NCCL INFO Retrieving state for Socket
clara10:2702493:2702998 [1] NCCL INFO Initialized state 0 for Socket
clara10:2702492:2702995 [0] NCCL INFO TOPO/NET : Importing network plugins to topology
clara10:2702492:2702995 [0] NCCL INFO Retrieving state for Socket
clara10:2702492:2702995 [0] NCCL INFO Initialized state 0 for Socket
clara10:2702493:2702998 [1] NCCL INFO ncclTopoPopulateNics : Filled bond0 in topo with pciPath=(null) keep=1 coll=(null)
clara10:2702492:2702995 [0] NCCL INFO ncclTopoPopulateNics : Filled bond0 in topo with pciPath=(null) keep=1 coll=(null)
clara10:2702493:2702998 [1] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
clara10:2702493:2702998 [1] NCCL INFO === System : maxBw 12.0 totalBw 12.0 ===
clara10:2702493:2702998 [1] NCCL INFO CPU/0-0 (1/2/-1)
clara10:2702493:2702998 [1] NCCL INFO + PCI[5000.0] - NIC/0-0
clara10:2702493:2702998 [1] NCCL INFO + PCI[12.0] - PCI/0-3000 (10b5874710b58747)
clara10:2702493:2702998 [1] NCCL INFO               + PCI[12.0] - GPU/0-5000 (0)
clara10:2702493:2702998 [1] NCCL INFO               + PCI[12.0] - GPU/0-6000 (1)
clara10:2702492:2702995 [0] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
clara10:2702493:2702998 [1] NCCL INFO ==========================================
clara10:2702493:2702998 [1] NCCL INFO GPU/0-5000 :GPU/0-5000 (0/5000.0/LOC) GPU/0-6000 (4/12.0/PHB) CPU/0-0 (2/12.0/PHB) 
clara10:2702493:2702998 [1] NCCL INFO GPU/0-6000 :GPU/0-5000 (4/12.0/PHB) GPU/0-6000 (0/5000.0/LOC) CPU/0-0 (2/12.0/PHB) 
clara10:2702493:2702998 [1] NCCL INFO Setting affinity for GPU 1 to 0f,0000000f
clara10:2702492:2702995 [0] NCCL INFO === System : maxBw 12.0 totalBw 12.0 ===
clara10:2702492:2702995 [0] NCCL INFO CPU/0-0 (1/2/-1)
clara10:2702492:2702995 [0] NCCL INFO + PCI[5000.0] - NIC/0-0
clara10:2702492:2702995 [0] NCCL INFO + PCI[12.0] - PCI/0-3000 (10b5874710b58747)
clara10:2702492:2702995 [0] NCCL INFO               + PCI[12.0] - GPU/0-5000 (0)
clara10:2702492:2702995 [0] NCCL INFO               + PCI[12.0] - GPU/0-6000 (1)
clara10:2702492:2702995 [0] NCCL INFO ==========================================
clara10:2702492:2702995 [0] NCCL INFO GPU/0-5000 :GPU/0-5000 (0/5000.0/LOC) GPU/0-6000 (4/12.0/PHB) CPU/0-0 (2/12.0/PHB) 
clara10:2702492:2702995 [0] NCCL INFO GPU/0-6000 :GPU/0-5000 (4/12.0/PHB) GPU/0-6000 (0/5000.0/LOC) CPU/0-0 (2/12.0/PHB) 
clara10:2702492:2702995 [0] NCCL INFO Setting affinity for GPU 0 to 0f,0000000f
clara10:2702493:2702998 [1] NCCL INFO Pattern 4, crossNic 0, nChannels 1, bw 6.000000/6.000000, type PHB/PIX, sameChannels 1
clara10:2702492:2702995 [0] NCCL INFO Pattern 4, crossNic 0, nChannels 1, bw 6.000000/6.000000, type PHB/PIX, sameChannels 1
clara10:2702492:2702995 [0] NCCL INFO  0 : GPU/0 GPU/1
clara10:2702493:2702998 [1] NCCL INFO  0 : GPU/0 GPU/1
clara10:2702492:2702995 [0] NCCL INFO Pattern 1, crossNic 0, nChannels 1, bw 12.000000/12.000000, type PHB/PIX, sameChannels 1
clara10:2702493:2702998 [1] NCCL INFO Pattern 1, crossNic 0, nChannels 1, bw 12.000000/12.000000, type PHB/PIX, sameChannels 1
clara10:2702492:2702995 [0] NCCL INFO  0 : GPU/0 GPU/1
clara10:2702493:2702998 [1] NCCL INFO  0 : GPU/0 GPU/1
clara10:2702493:2702998 [1] NCCL INFO comm 0x55c6b0c3d650 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
clara10:2702492:2702995 [0] NCCL INFO comm 0x55ba4623b530 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
clara10:2702492:2702995 [0] NCCL INFO Tree 0 : -1 -> 0 -> 1/-1/-1
clara10:2702493:2702998 [1] NCCL INFO Tree 0 : 0 -> 1 -> -1/-1/-1
clara10:2702492:2702995 [0] NCCL INFO Tree 1 : -1 -> 0 -> 1/-1/-1
clara10:2702493:2702998 [1] NCCL INFO Tree 1 : 0 -> 1 -> -1/-1/-1
clara10:2702492:2702995 [0] NCCL INFO Channel 00/02 : 0 1
clara10:2702493:2702998 [1] NCCL INFO Ring 00 : 0 -> 1 -> 0
clara10:2702493:2702998 [1] NCCL INFO Ring 01 : 0 -> 1 -> 0
clara10:2702492:2702995 [0] NCCL INFO Channel 01/02 : 0 1
clara10:2702493:2702998 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
clara10:2702492:2702995 [0] NCCL INFO Ring 00 : 1 -> 0 -> 1
clara10:2702493:2702998 [1] NCCL INFO P2P Chunksize set to 131072
clara10:2702492:2702995 [0] NCCL INFO Ring 01 : 1 -> 0 -> 1
clara10:2702492:2702995 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
clara10:2702492:2702995 [0] NCCL INFO P2P Chunksize set to 131072
clara10:2702492:2702995 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
clara10:2702493:2703064 [1] NCCL INFO [Proxy Service] Device 1 CPU core 1
clara10:2702493:2703065 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 35
clara10:2702492:2703066 [0] NCCL INFO [Proxy Service] Device 0 CPU core 34
clara10:2702492:2703067 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 1
clara10:2702493:2702998 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
clara10:2702493:2702998 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
clara10:2702492:2702995 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
clara10:2702492:2702995 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
clara10:2702492:2702995 [0] NCCL INFO CC Off, workFifoBytes 1048576
clara10:2702492:2702995 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
clara10:2702493:2702998 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
clara10:2702493:2702998 [1] NCCL INFO ncclCommInitRankConfig comm 0x55c6b0c3d650 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 6000 commId 0xcb051e40260ef976 - Init COMPLETE
clara10:2702492:2702995 [0] NCCL INFO ncclCommInitRankConfig comm 0x55ba4623b530 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 5000 commId 0xcb051e40260ef976 - Init COMPLETE
clara10:2702493:2702998 [1] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 2 total 0.25 (kernels 0.21, alloc 0.01, bootstrap 0.01, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.00, rest 0.00)
clara10:2702492:2702995 [0] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 2 total 0.25 (kernels 0.21, alloc 0.01, bootstrap 0.02, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.00, rest 0.00)
clara10:2702492:2702492 [0] NCCL INFO AllGather: opCount 0 sendbuff 0x6020ee400 recvbuff 0x6020eea00 count 1 datatype 4 op 0 root 0 comm 0x55ba4623b530 [nranks=2] stream 0x55ba3aeec0b0
clara10:2702493:2702493 [1] NCCL INFO AllGather: opCount 0 sendbuff 0x6020ee400 recvbuff 0x6020eea00 count 1 datatype 4 op 0 root 0 comm 0x55c6b0c3d650 [nranks=2] stream 0x55c6aed06580
clara10:2702493:2703069 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
clara10:2702492:2703068 [0] NCCL INFO Channel 00 : 0[0] -> 1[1] via SHM/direct/direct
clara10:2702493:2703069 [1] NCCL INFO Channel 01 : 1[1] -> 0[0] via SHM/direct/direct
clara10:2702492:2703068 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
clara10:2702492:2703068 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
clara10:2702493:2703069 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
clara10:2702492:2702492 [0] NCCL INFO Broadcast: opCount 1 sendbuff 0x6020eea00 recvbuff 0x6020eea00 count 54 datatype 4 op 0 root 0 comm 0x55ba4623b530 [nranks=2] stream 0x55ba3aeec0b0
clara10:2702493:2702493 [1] NCCL INFO Broadcast: opCount 1 sendbuff 0x6020eea00 recvbuff 0x6020eea00 count 54 datatype 4 op 0 root 0 comm 0x55c6b0c3d650 [nranks=2] stream 0x55c6aed06580
clara10:2702492:2702492 [0] NCCL INFO Broadcast: opCount 2 sendbuff 0x6020ee400 recvbuff 0x6020ee400 count 243304 datatype 7 op 0 root 0 comm 0x55ba4623b530 [nranks=2] stream 0x55ba3aeec0b0
clara10:2702493:2702493 [1] NCCL INFO Broadcast: opCount 2 sendbuff 0x6020ee400 recvbuff 0x6020ee400 count 243304 datatype 7 op 0 root 0 comm 0x55c6b0c3d650 [nranks=2] stream 0x55c6aed06580
2025-07-14 03:11:05,157 - rank_0 - INFO - Model created with 243304 parameters
