[2025-07-14 12:13:00] Starting SLURM job 14911991 on clara07.sc.uni-leipzig.de
[2025-07-14 12:13:00] Job parameters: 4 tasks, 4 GPUs, 1 nodes
[2025-07-14 12:13:00] Loading required modules...
[2025-07-14 12:13:02] Activating conda environment...
[2025-07-14 12:13:02] Verifying environment...
Python 3.10.18
PyTorch version: 2.7.1+cu126
CUDA available: True
CUDA devices: 4
[2025-07-14 12:13:20] Checking training script...
[2025-07-14 12:13:21] Training script found: -rw-r--r-- 1 ci72buri sc_users 17214 Jul 14 03:14 train_vae.py
[2025-07-14 12:13:21] Testing training script import...
Training script import: SUCCESS
[2025-07-14 12:13:34] Checking required modules...
torch: OK
torch.distributed: OK
numpy: OK
wandb: OK
All required modules available
[2025-07-14 12:13:38] Configuring NCCL settings...
[2025-07-14 12:13:38] Setting up distributed training configuration...
[2025-07-14 12:13:38] Distributed training configuration:
[2025-07-14 12:13:38]   MASTER_ADDR: 172.26.10.7
[2025-07-14 12:13:38]   MASTER_PORT: 20773
[2025-07-14 12:13:38]   WORLD_SIZE: 4
[2025-07-14 12:13:38]   NODE_RANK: 0
[2025-07-14 12:13:38]   SLURM_GPUS_ON_NODE: 4
[2025-07-14 12:13:38]   SLURM_JOB_NUM_NODES: 1
[2025-07-14 12:13:38] Testing network connectivity...
PING 172.26.10.7 (172.26.10.7) 56(84) bytes of data.
64 bytes from 172.26.10.7: icmp_seq=1 ttl=64 time=0.037 ms

--- 172.26.10.7 ping statistics ---
1 packets transmitted, 1 received, 0% packet loss, time 0ms
rtt min/avg/max/mdev = 0.037/0.037/0.037/0.000 ms
[2025-07-14 12:13:38] Testing GPU availability...
Mon Jul 14 12:13:38 2025       
+---------------------------------------------------------------------------------------+
| NVIDIA-SMI 535.230.02             Driver Version: 535.230.02   CUDA Version: 12.2     |
|-----------------------------------------+----------------------+----------------------+
| GPU  Name                 Persistence-M | Bus-Id        Disp.A | Volatile Uncorr. ECC |
| Fan  Temp   Perf          Pwr:Usage/Cap |         Memory-Usage | GPU-Util  Compute M. |
|                                         |                      |               MIG M. |
|=========================================+======================+======================|
|   0  Tesla V100-PCIE-32GB           On  | 00000000:05:00.0 Off |                    0 |
| N/A   31C    P0              26W / 250W |      0MiB / 32768MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   1  Tesla V100-PCIE-32GB           On  | 00000000:29:00.0 Off |                    0 |
| N/A   25C    P0              24W / 250W |      0MiB / 32768MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   2  Tesla V100-PCIE-32GB           On  | 00000000:43:00.0 Off |                    0 |
| N/A   27C    P0              25W / 250W |      0MiB / 32768MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
|   3  Tesla V100-PCIE-32GB           On  | 00000000:64:00.0 Off |                    0 |
| N/A   30C    P0              26W / 250W |      0MiB / 32768MiB |      0%      Default |
|                                         |                      |                  N/A |
+-----------------------------------------+----------------------+----------------------+
                                                                                         
+---------------------------------------------------------------------------------------+
| Processes:                                                                            |
|  GPU   GI   CI        PID   Type   Process name                            GPU Memory |
|        ID   ID                                                             Usage      |
|=======================================================================================|
|  No running processes found                                                           |
+---------------------------------------------------------------------------------------+
[2025-07-14 12:13:38] Checking torchrun availability...
/home/sc.uni-leipzig.de/ci72buri/.conda/envs/cell-vae/bin/torchrun
usage: torchrun [-h] [--nnodes NNODES] [--nproc-per-node NPROC_PER_NODE] [--rdzv-backend RDZV_BACKEND] [--rdzv-endpoint RDZV_ENDPOINT] [--rdzv-id RDZV_ID] [--rdzv-conf RDZV_CONF] [--standalone]
                [--max-restarts MAX_RESTARTS] [--monitor-interval MONITOR_INTERVAL] [--start-method {spawn,fork,forkserver}] [--role ROLE] [-m] [--no-python] [--run-path] [--log-dir LOG_DIR] [-r REDIRECTS] [-t TEE]
                [--local-ranks-filter LOCAL_RANKS_FILTER] [--node-rank NODE_RANK] [--master-addr MASTER_ADDR] [--master-port MASTER_PORT] [--local-addr LOCAL_ADDR] [--logs-specs LOGS_SPECS]
                training_script ...

[2025-07-14 12:13:41] Testing basic torchrun functionality...
Basic torchrun test passed
[2025-07-14 12:13:47] Creating distributed test script...
[2025-07-14 12:13:47] Testing distributed functionality...
Rank 1/2: Distributed initialization successfulRank 0/2: Distributed initialization successful

Rank 0: Using device cuda:0
Rank 1: Using device cuda:1
Rank 1: Basic tensor operations successful
Rank 0: Basic tensor operations successful
Rank 0: Test completed successfullyRank 1: Test completed successfully

[2025-07-14 12:13:54] Starting distributed training with verbose output...
[2025-07-14 12:13:54] Command: torchrun --nproc_per_node=4 --nnodes=1 --node_rank=0 --rdzv_backend=c10d --rdzv_endpoint=172.26.10.7:20773 train_vae.py
[2025-07-14 12:13:54] Testing with 2 processes first...
[W714 12:13:56.025101919 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara07.sc.uni-leipzig.de]:20773 (errno: 97 - Address family not supported by protocol).
[W714 12:13:56.350398348 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara07.sc.uni-leipzig.de]:36325 (errno: 97 - Address family not supported by protocol).
[W714 12:14:02.205926618 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara07.sc.uni-leipzig.de]:36325 (errno: 97 - Address family not supported by protocol).
[W714 12:14:02.206454552 socket.cpp:755] [c10d] The client socket cannot be initialized to connect to [clara07.sc.uni-leipzig.de]:36325 (errno: 97 - Address family not supported by protocol).
2025-07-14 12:14:02,938 - rank_0 - INFO - Rank 0/2 initialized on device cuda:0
wandb: Currently logged in as: coyfelix7 (coyfelix7-universit-t-leipzig) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.21.0
wandb: Run data is saved locally in /home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/wandb/run-20250714_121403-4p8621sr
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run jumping-star-172
wandb: ‚≠êÔ∏è View project at https://wandb.ai/coyfelix7-universit-t-leipzig/big_data_vae
wandb: üöÄ View run at https://wandb.ai/coyfelix7-universit-t-leipzig/big_data_vae/runs/4p8621sr
Using VAE-optimized preprocessing...
Using VAE-optimized preprocessing...
Dataset loaded: 20000 cells √ó 100 genes
Dataset loaded: 20000 cells √ó 100 genes
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
/home/sc.uni-leipzig.de/ci72buri/projects/vae/Leipzig_big_data_praktikum_gene_expression_autoencoder/autoCell/data_loader.py:152: ImplicitModificationWarning: Modifying `X` on a view results in data being overridden
  self.adata.X = X
Dataset loaded: 20000 cells √ó 100 genes
Dataset loaded: 20000 cells √ó 100 genes
2025-07-14 12:14:15,560 - rank_0 - INFO - Data loaders created. Dataset size: 20000
clara07:3314146:3314146 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara07:3314146:3314146 [0] NCCL INFO cudaDriverVersion 12020
clara07:3314146:3314146 [0] NCCL INFO NCCL version 2.26.2+cuda12.2
clara07:3314146:3314146 [0] NCCL INFO Comm config Blocking set to 1
clara07:3314147:3314147 [1] NCCL INFO cudaDriverVersion 12020
clara07:3314147:3314147 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara07:3314147:3314147 [1] NCCL INFO NCCL version 2.26.2+cuda12.2
clara07:3314147:3314147 [1] NCCL INFO Comm config Blocking set to 1
clara07:3314147:3314673 [1] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
clara07:3314147:3314673 [1] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
clara07:3314147:3314673 [1] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara07:3314146:3314672 [0] NCCL INFO NET/Plugin: Could not find: libnccl-net.so. Using internal net plugin.
clara07:3314146:3314672 [0] NCCL INFO NCCL_IB_DISABLE set by environment to 1.
clara07:3314146:3314672 [0] NCCL INFO NCCL_SOCKET_IFNAME set by environment to bond0
clara07:3314147:3314673 [1] NCCL INFO NET/Socket : Using [0]bond0:172.26.10.7<0>
clara07:3314146:3314672 [0] NCCL INFO NET/Socket : Using [0]bond0:172.26.10.7<0>
clara07:3314147:3314673 [1] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
clara07:3314147:3314673 [1] NCCL INFO Using network Socket
clara07:3314146:3314672 [0] NCCL INFO PROFILER/Plugin: Could not find: libnccl-profiler.so. 
clara07:3314146:3314672 [0] NCCL INFO Using network Socket
clara07:3314147:3314673 [1] NCCL INFO ncclCommInitRankConfig comm 0x556fc06e6520 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 29000 commId 0x4840ae23aa276a4b - Init START
clara07:3314146:3314672 [0] NCCL INFO ncclCommInitRankConfig comm 0x56163f1a5300 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 5000 commId 0x4840ae23aa276a4b - Init START
clara07:3314146:3314672 [0] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
clara07:3314147:3314673 [1] NCCL INFO RAS client listening socket at 127.0.0.1<28028>
clara07:3314146:3314672 [0] NCCL INFO TOPO/NET : Importing network plugins to topology
clara07:3314146:3314672 [0] NCCL INFO Retrieving state for Socket
clara07:3314146:3314672 [0] NCCL INFO Initialized state 0 for Socket
clara07:3314147:3314673 [1] NCCL INFO TOPO/NET : Importing network plugins to topology
clara07:3314147:3314673 [1] NCCL INFO Retrieving state for Socket
clara07:3314147:3314673 [1] NCCL INFO Initialized state 0 for Socket
clara07:3314146:3314672 [0] NCCL INFO ncclTopoPopulateNics : Filled bond0 in topo with pciPath=(null) keep=1 coll=(null)
clara07:3314147:3314673 [1] NCCL INFO ncclTopoPopulateNics : Filled bond0 in topo with pciPath=(null) keep=1 coll=(null)
clara07:3314147:3314673 [1] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
clara07:3314147:3314673 [1] NCCL INFO === System : maxBw 12.0 totalBw 12.0 ===
clara07:3314147:3314673 [1] NCCL INFO CPU/0-0 (1/2/-1)
clara07:3314147:3314673 [1] NCCL INFO + PCI[5000.0] - NIC/0-0
clara07:3314147:3314673 [1] NCCL INFO + SYS[16.0] - CPU/0-1
clara07:3314147:3314673 [1] NCCL INFO + PCI[12.0] - PCI/0-3000 (10b5874710b58747)
clara07:3314147:3314673 [1] NCCL INFO               + PCI[12.0] - GPU/0-5000 (0)
clara07:3314147:3314673 [1] NCCL INFO CPU/0-1 (1/2/-1)
clara07:3314147:3314673 [1] NCCL INFO + SYS[16.0] - CPU/0-0
clara07:3314147:3314673 [1] NCCL INFO + PCI[12.0] - PCI/0-26000 (10b5874710b58747)
clara07:3314147:3314673 [1] NCCL INFO               + PCI[12.0] - GPU/0-29000 (1)
clara07:3314146:3314672 [0] NCCL INFO NCCL_P2P_DISABLE set by environment to 1
clara07:3314147:3314673 [1] NCCL INFO ==========================================
clara07:3314147:3314673 [1] NCCL INFO GPU/0-5000 :GPU/0-5000 (0/5000.0/LOC) GPU/0-29000 (5/12.0/SYS) CPU/0-0 (2/12.0/PHB) CPU/0-1 (3/12.0/SYS) 
clara07:3314147:3314673 [1] NCCL INFO GPU/0-29000 :GPU/0-5000 (5/12.0/SYS) GPU/0-29000 (0/5000.0/LOC) CPU/0-0 (3/12.0/SYS) CPU/0-1 (2/12.0/PHB) 
clara07:3314147:3314673 [1] NCCL INFO Setting affinity for GPU 1 to 0300,00000300
clara07:3314146:3314672 [0] NCCL INFO === System : maxBw 12.0 totalBw 12.0 ===
clara07:3314146:3314672 [0] NCCL INFO CPU/0-0 (1/2/-1)
clara07:3314146:3314672 [0] NCCL INFO + PCI[5000.0] - NIC/0-0
clara07:3314146:3314672 [0] NCCL INFO + SYS[16.0] - CPU/0-1
clara07:3314146:3314672 [0] NCCL INFO + PCI[12.0] - PCI/0-3000 (10b5874710b58747)
clara07:3314146:3314672 [0] NCCL INFO               + PCI[12.0] - GPU/0-5000 (0)
clara07:3314146:3314672 [0] NCCL INFO CPU/0-1 (1/2/-1)
clara07:3314146:3314672 [0] NCCL INFO + SYS[16.0] - CPU/0-0
clara07:3314146:3314672 [0] NCCL INFO + PCI[12.0] - PCI/0-26000 (10b5874710b58747)
clara07:3314146:3314672 [0] NCCL INFO               + PCI[12.0] - GPU/0-29000 (1)
clara07:3314146:3314672 [0] NCCL INFO ==========================================
clara07:3314146:3314672 [0] NCCL INFO GPU/0-5000 :GPU/0-5000 (0/5000.0/LOC) GPU/0-29000 (5/12.0/SYS) CPU/0-0 (2/12.0/PHB) CPU/0-1 (3/12.0/SYS) 
clara07:3314146:3314672 [0] NCCL INFO GPU/0-29000 :GPU/0-5000 (5/12.0/SYS) GPU/0-29000 (0/5000.0/LOC) CPU/0-0 (3/12.0/SYS) CPU/0-1 (2/12.0/PHB) 
clara07:3314146:3314672 [0] NCCL INFO Setting affinity for GPU 0 to 03,00000003
clara07:3314146:3314672 [0] NCCL INFO Pattern 4, crossNic 0, nChannels 1, bw 12.000000/12.000000, type SYS/PIX, sameChannels 1
clara07:3314146:3314672 [0] NCCL INFO  0 : GPU/0 GPU/1
clara07:3314147:3314673 [1] NCCL INFO Pattern 4, crossNic 0, nChannels 1, bw 12.000000/12.000000, type SYS/PIX, sameChannels 1
clara07:3314147:3314673 [1] NCCL INFO  0 : GPU/0 GPU/1
clara07:3314146:3314672 [0] NCCL INFO Pattern 1, crossNic 0, nChannels 1, bw 12.000000/12.000000, type SYS/PIX, sameChannels 1
clara07:3314146:3314672 [0] NCCL INFO  0 : GPU/0 GPU/1
clara07:3314147:3314673 [1] NCCL INFO Pattern 1, crossNic 0, nChannels 1, bw 12.000000/12.000000, type SYS/PIX, sameChannels 1
clara07:3314147:3314673 [1] NCCL INFO  0 : GPU/0 GPU/1
clara07:3314147:3314673 [1] NCCL INFO comm 0x556fc06e6520 rank 1 nRanks 2 nNodes 1 localRanks 2 localRank 1 MNNVL 0
clara07:3314146:3314672 [0] NCCL INFO comm 0x56163f1a5300 rank 0 nRanks 2 nNodes 1 localRanks 2 localRank 0 MNNVL 0
clara07:3314146:3314672 [0] NCCL INFO Tree 0 : -1 -> 0 -> 1/-1/-1
clara07:3314147:3314673 [1] NCCL INFO Tree 0 : 0 -> 1 -> -1/-1/-1
clara07:3314146:3314672 [0] NCCL INFO Tree 1 : -1 -> 0 -> 1/-1/-1
clara07:3314147:3314673 [1] NCCL INFO Tree 1 : 0 -> 1 -> -1/-1/-1
clara07:3314146:3314672 [0] NCCL INFO Channel 00/02 : 0 1
clara07:3314146:3314672 [0] NCCL INFO Channel 01/02 : 0 1
clara07:3314147:3314673 [1] NCCL INFO Ring 00 : 0 -> 1 -> 0
clara07:3314146:3314672 [0] NCCL INFO Ring 00 : 1 -> 0 -> 1
clara07:3314147:3314673 [1] NCCL INFO Ring 01 : 0 -> 1 -> 0
clara07:3314146:3314672 [0] NCCL INFO Ring 01 : 1 -> 0 -> 1
clara07:3314147:3314673 [1] NCCL INFO Trees [0] -1/-1/-1->1->0 [1] -1/-1/-1->1->0
clara07:3314146:3314672 [0] NCCL INFO Trees [0] 1/-1/-1->0->-1 [1] 1/-1/-1->0->-1
clara07:3314147:3314673 [1] NCCL INFO P2P Chunksize set to 131072
clara07:3314146:3314672 [0] NCCL INFO P2P Chunksize set to 131072
clara07:3314146:3314672 [0] NCCL INFO Check P2P Type intraNodeP2pSupport 0 directMode 0
clara07:3314146:3314678 [0] NCCL INFO [Proxy Service] Device 0 CPU core 1
clara07:3314146:3314680 [0] NCCL INFO [Proxy Service UDS] Device 0 CPU core 0
clara07:3314147:3314679 [1] NCCL INFO [Proxy Service] Device 1 CPU core 41
clara07:3314147:3314681 [1] NCCL INFO [Proxy Service UDS] Device 1 CPU core 8
clara07:3314147:3314673 [1] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
clara07:3314147:3314673 [1] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
clara07:3314146:3314672 [0] NCCL INFO threadThresholds 8/8/64 | 16/8/64 | 512 | 512
clara07:3314146:3314672 [0] NCCL INFO 2 coll channels, 2 collnet channels, 0 nvls channels, 2 p2p channels, 2 p2p channels per peer
clara07:3314146:3314672 [0] NCCL INFO CC Off, workFifoBytes 1048576
clara07:3314147:3314673 [1] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
clara07:3314147:3314673 [1] NCCL INFO ncclCommInitRankConfig comm 0x556fc06e6520 rank 1 nranks 2 cudaDev 1 nvmlDev 1 busId 29000 commId 0x4840ae23aa276a4b - Init COMPLETE
clara07:3314147:3314673 [1] NCCL INFO Init timings - ncclCommInitRankConfig: rank 1 nranks 2 total 0.47 (kernels 0.44, alloc 0.01, bootstrap 0.00, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.00, rest 0.00)
clara07:3314146:3314672 [0] NCCL INFO TUNER/Plugin: Could not find: libnccl-tuner.so. Using internal tuner plugin.
clara07:3314146:3314672 [0] NCCL INFO ncclCommInitRankConfig comm 0x56163f1a5300 rank 0 nranks 2 cudaDev 0 nvmlDev 0 busId 5000 commId 0x4840ae23aa276a4b - Init COMPLETE
clara07:3314146:3314672 [0] NCCL INFO Init timings - ncclCommInitRankConfig: rank 0 nranks 2 total 0.48 (kernels 0.44, alloc 0.01, bootstrap 0.00, allgathers 0.00, topo 0.01, graphs 0.00, connections 0.00, rest 0.00)
clara07:3314146:3314146 [0] NCCL INFO AllGather: opCount 0 sendbuff 0x6020ee400 recvbuff 0x6020eea00 count 1 datatype 4 op 0 root 0 comm 0x56163f1a5300 [nranks=2] stream 0x561633de48b0
clara07:3314147:3314147 [1] NCCL INFO AllGather: opCount 0 sendbuff 0x6020ee400 recvbuff 0x6020eea00 count 1 datatype 4 op 0 root 0 comm 0x556fc06e6520 [nranks=2] stream 0x556fbe7b1690
clara07:3314147:3314683 [1] NCCL INFO Channel 00 : 1[1] -> 0[0] via SHM/direct/direct
clara07:3314147:3314683 [1] NCCL INFO Channel 01 : 1[1] -> 0[0] via SHM/direct/direct
clara07:3314146:3314682 [0] NCCL INFO Channel 00 : 0[0] -> 1[1] via SHM/direct/direct
clara07:3314146:3314682 [0] NCCL INFO Channel 01 : 0[0] -> 1[1] via SHM/direct/direct
clara07:3314146:3314682 [0] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
clara07:3314147:3314683 [1] NCCL INFO Connected all rings, use ring PXN 0 GDR 1
clara07:3314147:3314147 [1] NCCL INFO Broadcast: opCount 1 sendbuff 0x6020eea00 recvbuff 0x6020eea00 count 54 datatype 4 op 0 root 0 comm 0x556fc06e6520 [nranks=2] stream 0x556fbe7b1690
clara07:3314146:3314146 [0] NCCL INFO Broadcast: opCount 1 sendbuff 0x6020eea00 recvbuff 0x6020eea00 count 54 datatype 4 op 0 root 0 comm 0x56163f1a5300 [nranks=2] stream 0x561633de48b0
clara07:3314146:3314146 [0] NCCL INFO Broadcast: opCount 2 sendbuff 0x6020ee400 recvbuff 0x6020ee400 count 243304 datatype 7 op 0 root 0 comm 0x56163f1a5300 [nranks=2] stream 0x561633de48b0
clara07:3314147:3314147 [1] NCCL INFO Broadcast: opCount 2 sendbuff 0x6020ee400 recvbuff 0x6020ee400 count 243304 datatype 7 op 0 root 0 comm 0x556fc06e6520 [nranks=2] stream 0x556fbe7b1690
2025-07-14 12:14:21,188 - rank_0 - INFO - Model created with 243304 parameters
